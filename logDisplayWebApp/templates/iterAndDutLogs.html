<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='tableStyles.css') }}">
    <script src="{{ url_for('static', path='displayLogs.js') }}"></script>
    <title>Data Table with FastAPI and Jinja2</title>
</head>

<body>


    <!-- Table to display data -->
    <center>
        <h1>Summary of Executions</h1>
        <table class="summary-table">
               <caption>Summary Table</caption>
            <tbody>
            <tr>
                <td>Total Executions</td>
                <td>{{ summary["number_of_iterations"] }}</td>
            </tr>
            <tr>
                <td>Successful Executions</td>
                <td>{{ summary["Pass Count"] }}</td>
            </tr>
            <tr>
                <td>Failed Executions</td>
                <td>{{ summary["Fail Count"]["Count"] }}</td>
            </tr>
            <tr>
                <td>DUT Platform</td>
                <td>{{ summary["platform"] }}</td>
            </tr>
            <tr>
                <td>Commissioning Method</td>
                <td>{{ summary["commissioning_method"] }}</td>
            </tr>
            </tbody>
        </table>
        <table class="data-table">
        <thead>
            <tr>
                <th>Iteration Number</th>
                <th>Test Result</th>
                <th>Time of Execution</th>
                <th>Logs</th>
            </tr>
        </thead>
        <tbody>
            {% for row in table_data %}
                <tr>
                    <td>{{ row.dir_name }}</td>
                    <td>{{ row.iteration_result }}</td>
                    <td>{{ row.dir_last_modified }}</td>
                    <td><button onclick="dutLogsDisplay('{{dir_path}}','{{row.dir_name}}','iter')">Iteration Logs</button>,
                        <button onclick="dutLogsDisplay('{{dir_path}}','{{row.dir_name}}','dut')">DUT Logs</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Pagination -->
    <div class="pagination">
        {% if current_page > 1 %}
            <a href="?page=1&page_size={{ current_page_size }}&filters={{ current_filter }}&dir_path={{dir_path}}">First</a>
            <a href="?page={{ current_page - 1 }}&page_size={{ current_page_size }}&filters={{ current_filter }}&dir_path={{dir_path}}">Previous</a>
        {% endif %}

        {% for page_num in range(1, total_pages + 1) %}
            <a href="?page={{ page_num }}&page_size={{ current_page_size }}&filters={{ current_filter }}&dir_path={{dir_path}}" {% if page_num == current_page %}class="active"{% endif %}>{{ page_num }}</a>
        {% endfor %}

        {% if current_page < total_pages %}
            <a href="?page={{ current_page + 1 }}&page_size={{ current_page_size }}&filters={{ current_filter }}&dir_path={{dir_path}}">Next</a>
            <a href="?page={{ total_pages }}&page_size={{ current_page_size }}&filters={{ current_filter }}&dir_path={{dir_path}}">Last</a>
        {% endif %}
    </div>
    <label for="rows">Rows per page:</label>
    <select id="rows" name="rows" onchange="location = this.value;">
        <option value="?page={{current_page}}&page_size=10&filters={{ current_filter }}&dir_path={{dir_path}}">10</option>
        <option value="?page={{current_page}}&page_size=20&filters={{ current_filter }}&dir_path={{dir_path}}">20</option>
        <option value="?page={{current_page}}&page_size=50&filters={{ current_filter }}&dir_path={{dir_path}}">50</option>
        <option value="?page={{current_page}}&page_size=100&filters={{ current_filter }}&dir_path={{dir_path}}">100</option>
    </select>

    <!-- Age filter dropdown -->
    <label for="filter">Filter by Pass/Fail/All:</label>
    <select id="filter" name="filter" onchange="location = this.value;">
        <option value="?page={{current_page}}&page_size={{ current_page_size }}&filters=all&dir_path={{dir_path}}" {% if current_filter == 'all' %}selected{% endif %}>All</option>
        <option value="?page={{current_page}}&page_size={{ current_page_size }}&filters=pass&dir_path={{dir_path}}" {% if current_filter == 'pass' %}selected{% endif %}>Pass</option>
        <option value="?page={{current_page}}&page_size={{ current_page_size }}&filters=fail&dir_path={{dir_path}}" {% if current_filter == 'fail' %}selected{% endif %}>Fail</option>
    </select>
    </center>

</body>
</html>
